# Домашнее задание к занятию "12.8. «Резервное копирование баз данных» - Баранков Антон"

### Задание 1

1.1. Полное резервное копирование базы данных за предыдущий день. Полное резервное копирование базы данных позволяет сделать копию всей базы данных, включая все объекты и данные системных таблиц, поэтому при восстановлении данных из полной резервной копии можно восстановить данные в полном объеме за предыдущий день. Также обычно всегда делается ежедневное полное резервное копирование.  
1.2. Инкрементное резервное копирование базы данных каждый час, либо можно использовать дифференциальное резервное копирование. Дифференциальное копирование сохраняет только изменения, которые произошли с момента последнего полного резервного копирования, а инкрементное копирование сохраняет только изменения, которые произошли с момента последнего резервного копирования. Нет смысла делать полное резервное копирование, т.к. за каждый час слишком мало изменений, по сравнению с полным размером базы, при этом ежечасное полное копирование даст сильную нагрузку на работу серверов и на сеть за счет большого объема данных.  
1.3.* Для моментального переключения на работающую или починенную базу данных можно использовать технологию репликации. Технология репликации используется для создания копий базы данных с главного сервера и ее распределения на другие серверы. Если главный сервер выходит из строя, то осуществляется переключение работы на другие серверы без простоя, а также возможно переключение на починенную базу данных.  

### Задание 2
2.1. Пример команды резервирования данных:  
pg_dump -U username -h localhost dbname > backup.sql  
где:  
username - имя пользователя;  
localhost - имя хоста;  
dbname - имя базы данных;  
backup.sql - имя файла резервной копии.  

Пример команды восстановления БД:  
pg_restore -U username -h localhost -d dbname backup.sql  
где:  
username - имя пользователя;  
localhost - имя хоста;  
dbname - имя базы данных;  
backup.sql - имя файла резервной копии.  

2.1.* Для автоматизации процесса можно использовать утилиту wal-g, либо можно написать скрипт и использовать утилиту cron.  

### Задание 3
3.1. mysqlbackup --incremental --incremental-base=dir/to/full/backup/dir --user=user_name --password=password backup-to-directory  
где  
incremental - опция для создания инкрементальной резервной копии БД    
incremental-base=dir/to/full/backup/dir - опция для указания директории с полной резервной копией, на основе которой будет создана инкрементальная резервная копия  
user=user_name - опция для указания имени пользователя MySQL  
password=password - опция для указания пароля пользователя MySQL  
backup-to-directory - директория, в которую будет сохранена инкрементальная резервная копия.  

3.1.* Если необходимо сделать резервное копирование базы данных без остановки работы приложения, то можно создать реплику и выполнять резервное копирование с реплики, не затрагивая основную БД.  
Если требуется повысить производительность приложения, можно использовать реплику для распределения нагрузки между несколькими серверами.  
В случае отказа основной БД, можно быстро переключиться на реплику и продолжить работу без простоев.
